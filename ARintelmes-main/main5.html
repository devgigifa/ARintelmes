
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <!-- ler qr code -->
    <script src="https://unpkg.com/jsqr@1.3.1/dist/jsQR.js"></script>

    <script>
        AFRAME.registerComponent('cursor-listener', {
            schema: {},
            init: function() {
                this.el.addEventListener('click', function(evt) {
                    if (this.el.id === 'rightbox') {
                        alert("manutenção");
                        const boxMaintenance = document.createElement('a-box');
                        boxMaintenance.setAttribute('position', '0 2.3 -3');
                        boxMaintenance.setAttribute('rotation', '0 0 0');
                        boxMaintenance.setAttribute('color', '#00a335');
                        boxMaintenance.setAttribute('scale', '2 2 1');
                        document.querySelector('a-scene').appendChild(boxMaintenance);
                    } else if (this.el.id === 'leftbox') {
                        alert("status");
                        const boxStatus = document.createElement('a-box');
                        boxStatus.setAttribute('position', '0 2.3 -3');
                        boxStatus.setAttribute('rotation', '0 0 0');
                        boxStatus.setAttribute('color', '#00a335');
                        boxStatus.setAttribute('scale', '2 2 1');
                        document.querySelector('a-scene').appendChild(boxStatus);
                    }
                });
            }
        });
    </script>

    <style>
        #video {
            width: 100%;
            height: 100vh;
            object-fit: cover;
        }
        #scene {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background-color: transparent;
        }
    </style>
</head>

<body>
    <a-scene 
        vr-mode-ui="enabled: false;"
        embedded arjs="sourceType: webcam; debugUIEnabled: false;"
        id="scene"
    >
    <a-marker 
        id="marker" 
        type="pattern" 
        url="https://cdn.glitch.global/469bf26b-d54a-42ba-b93a-9badfef4d1e2/pattern-frame1.patt?v=1722364839104" 
        position="0 0 0" 
        rotation="0 0 0"
    >
        <a-entity 
        cursor="fuse: true; rayOrigin: mouse; objects: .clickable; " raycaster="far: 1000; interval: 100"
        ></a-entity>

        <a-box 
            id="rightbox" 
            position="0.6 1 -3" 
            rotation="0 0 0" 
            color="#50788a" 
            scale="0.8  0.2 0.3" 
            cursor-listener  class="clickable"       
        ></a-box>

        <a-box 
            id="leftbox" 
            position="-0.6 1 -3" 
            rotation="0 0 0" 
            color="#50788a" 
            scale="0.8  0.2 0.3" 
            cursor-listener    class="clickable"     
        ></a-box>

        <a-text value="maintenance" color="white" scale="1.8 1.8 1.8" position="0.5 1.1 -2.5" align="center" width="1.3"></a-text>
        <a-text value="status" color="white" scale="1.8 1.8 1.8" position="-0.5 1.1 -2.5" align="center" width="1.3"></a-text>           
    
        <!-- faz com que os elementos não fiquem se movendo aleatoriamente pela tela -->
        <a-entity camera position="0 1.7 0">
            <video id="video" autoplay playsinline></video>
        </a-entity>
    </a-marker>
    </a-scene>
</body>
</html>
